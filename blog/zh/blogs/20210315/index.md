---
title: Wifi连接受到的电磁干扰
description: 奇怪的知识增加了
tags: 
- 一点趣事
---


[[toc]]

# Wifi连接受到的电磁干扰

## 关于 HDMI

最近遇到了一个很玄学的问题，笔记本电脑带到实验室就没法连 SJTU 的无线上网了，尝试了各种设置均无效，以为是无线网卡出问题了。结果去上课又发现好好的。难道是网络信息中心针对我，只有我座位上的无线有问题 = = 

回到实验室后，我离开了座位，跑到了远一点的地方测试，可以上网了，没想到还真是我座位的问题（×）。对比后发现区别只在电源线、HDMI 转接线和键盘 USB 连接线。插拔 HDMI 转接线总算确定了问题源头。老E提醒我，他暑假曾有一段时间困扰于 USB 3.0 和无线网卡相互干扰，插上移动硬盘就断网，也是折腾了很久才排查清楚。

唉这转接线前两天还用得好好的，拿来打狒狒14也没问题，就很无语。

知道了无线网卡和 HDMI 线有可能出现电磁干扰，在[知乎](https://www.zhihu.com/question/34787444/answer/60590570)上找到了这样一个回答，原问题很有趣，是在讨论[你碰到过的最难调试的 Bug 是什么样的？](https://www.zhihu.com/question/34787444/answer/60590570)，里面有一个很经典的[香草冰淇淋的故事](#香草冰淇淋Bug)（我也不知道真实性）。

> **HDMI线有干扰**，影响到了WIFI信道，加上这个AC7260无线网卡本身设计不良，容易串入干扰。由于HDMI工作频率是根据视频信号码率决定的，通过修改分辨率，改变HDMI工作频率，使干扰谐波信号跳开了2.4G和5G信道。另外通过HDMI传输信号会有一个接口协商初始化过程，只有电视机切换到这个HDMI源，完成初始化，才会在HDMI线上有数据，这点和VGA,YPBPR等模拟信号不同。
>
> 之前分析问题没有往HDMI方面想，主要是视频播放会有一个缓冲，因此，刚开电视切换到HDMI的时候，一切看起来是正常的(但此时后台网络已断)，过了几分钟缓冲读完了才停顿。因此分析问题时很难和HDMI线联系上。
>
> 此问题其实做音视频类产品的项目经常遇见，由于HDMI频率高，传输长，因此很多输出源有意加重输出信号，导致EMI干扰严重，又由于很多HDMI线材质低劣，偷工减料，缺少屏蔽措施，因此HDMI接口往往成为电磁干扰的重灾区，也导致大量HDMI接口的兼容性问题(我这个破电视就挑信号源，有些1080P不显示)。因此能用YPBPR模拟线，或者能用DP接口，我都是躲开HDMI的。

## 转载：关于 USB 3.0

首先，需要明确一点事实，任何有线信号都会向外辐射电磁波，除非它是直流电（没有频率变化）、或者完全屏蔽。干扰的强度与线缆上传输的信号（如电压、电流、频率）有关。

举一个特别现实的例子：一般在高压线的下方，如果要传输以太网信号，最可靠的方法是用光纤，如果用双绞线铜缆传输信号，很有可能会被干扰。

大多数电子器件在设计的时候都要考虑电磁屏蔽和抗干扰的问题。所以，尽管USB3.0是有线信号，但仍然可能向外辐射电磁波，对其它信号产生干扰。

那么有人会问了，USB3.0不是5GHz吗？Wifi是2.4GHz怎么会有干扰呢？问题出在USB传输线上。

USB3.0的传输频率确实是5GHz串行，但USB3.0使用4条数据线组成2组，每组负责一个传输方向，实现全双工双向5GHz，而每条数据线的基准频率是2.5GHz。

所以，总带宽是5GHz没错，但每条线上是2.5GHz，这个频率距离2.4G Wifi的频率太近了，又因为高频设备大多数都使用了SSC技术（扩频时钟？）使得信号不完全分布在一个固定频率上，所以就波及了2.5GHz附近的其它频率，所以对Wifi和蓝牙产生了较大的干扰。

通常来说USB3.0线缆的屏蔽性是很好的，但主要的问题出在接头处。如果拆开一个USB3.0的线，会发现外面有屏蔽层之类的保护，但这些东西不是完全屏蔽的，在接头处是裸露的，并且不完全封闭，这就使得USB3.0在接头处对外产生了较大的干扰。

如果把移动硬盘的接头以及前半部分全屏蔽起来，就能大大降低干扰，而比较一下即使把整个硬盘都屏蔽起来，降低的效果不明显，说明干扰主要在接头部分。

所以，总结下来就是USB传输的时候会产生噪声，影响Wifi的使用，解决方法要么是使用屏蔽设备（包括USB线缆的接头都要改造），要么使用5G的wifi。

USB-IF有官方的文献，参考： http://www.usb.org/developers/

题外话：

1、USB3.1要搞10GHz传输了，那么按照规范上来看，数据线上的频率应该是5GHz，所以，如果有一天升级到USB3.1，那么5G Wifi恐怕也要中枪了。

2、传输频率低于总带宽的事情也算常见，网线（双绞线）就算一个，六类线(CAT6)以及更高规格的线缆上，总带宽是每条线的传输频率*数据线个数。

3、为什么移动设备不怎么愿意用USB3.0接口？因为移动设备太小，电磁环境太复杂，有Wifi和各种频率的手机信号，现在再来个USB3.0，电磁屏蔽不好做。加上本身USB2.0还算不上传输瓶颈，所以就不着急上USB3.0了。

## 香草冰淇淋Bug

2000年通用公司庞帝雅克部门收到一封客户投诉：

> "This is the second time I have written you, and I don't blame you for not answering me, because I kind of sounded crazy, but it is a fact that we have a tradition in our family of ice cream for dessert after dinner each night. But the kind of ice cream varies so, every night, after we've eaten, the whole family votes on which kind of ice cream we should have and I drive down to the store to get it. It's also a fact that I recently purchased a new Pontiac and since then my trips to the store have created a problem. You see, every time I buy vanilla ice cream, when I start back from the store my car won't start. If I get any other kind of ice cream, the car starts just fine. I want you to know I'm serious about this question, no matter how silly it sounds: 'What is there about a Pontiac that makes it not start when I get vanilla ice cream, and easy to start whenever I get any other kind?'"

“这是我为了同一件事第二次写信给你们，我不怪你们没有回信给我，因为我也知道大家都会认为我疯了，但这的确是一个事实。我们家有一个传统的习惯：就是在吃完晚餐后，都会以冰淇淋来当饭后甜点。由于冰淇淋的口味很多，所以每天在饭后才投票决定要吃哪种口味，等大家决定后，我就会开车去买。但最近我买了一部新的庞帝雅克后，问题就发生了。
你们知道吗？每当我买的冰淇淋是香草口味时，车子就发不动。但如果买的是其它口味，车子发动就顺得很。尽管这个问题听起来很猪头，但我是非常认真的。
为什么当我买了香草冰淇淋，这部庞帝雅克就会秀逗（不能发动），而我不管什么时候买其它口味的冰淇淋，它就是一尾活龙？为什么？为什么？”

尽管庞帝雅克的部门经理很难相信这个事情， 但还是派了一位工程师去查看究竟。
当工程师去找这位仁兄时，发现这封信竟是出自于一位事业成功、乐观、且受了高等教育的人，不像是恶意捣乱。

工程师和客户的见面时间刚好是在用完晚餐后，两人于是立刻驾上汽车往冰淇淋店开去。那个晚上投票结果是香草口味，当买好冰淇淋回到车上后 ，车子果然又趴窝了。

这位工程师之后又来了三个晚上：
第一晚，巧克力冰淇淋，车子正常。
第二晚，草莓冰淇淋，车子也没事。
第三晚，香草冰淇淋，车子又罢工了！

这位思维缜密的工程师，当然不会相信车子真的对香草冰激凌过敏。因此他继续不断用类似的行程进行测试，希望能解决这个问题。

工程师开始记下从开始到现在所发生的种种详细数据，如时间 、车子使用油的种类、车子开出及开回的时间等等，根据数据显示他有了一个结论：这位仁兄买香草冰淇淋所花的时间比其它口味的要少！

为什么呢？

原因是出在这家冰淇淋店的内部设置的问题。

因为，香草冰淇淋是最畅销的口味，店家为了让顾客每次都能很快的拿取，所以将香草口味特别分开陈列在 单独的冰柜，并将冰柜放置在店的前端；至于其它口味则放置在距离收银台较远的后端。

现在，工程师所要知道的疑问是：为什么这部车会因为从熄火到重新启动的时间较短就会秀逗？原因绝对不是香草冰淇淋的关系，工程师很快地浮现出答案，应该是**汽锁**(vapour lock)。

因为当这位仁兄买其它口味时，由于时间较久，引擎有足够的时间散热 ，重新发动就没有太大的问题。但是买香草口味时，由于花的时间较短，引擎太热以至于还无法让汽锁有足够的散热时间。

问题原因终于找到了。


# Reference
[你碰到过的最难调试的 Bug 是什么样的？](https://www.zhihu.com/question/34787444/answer/60590570)

[为什么WiFi和USB3.0会互相干扰？](https://blog.csdn.net/chrovery/article/details/47720731)